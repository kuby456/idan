<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>×˜×•×¤×¡ ××™× ×˜×™×™×§</title>
  <style>
    :root{
  --bg-color-1: #f7fbff;
  --bg-color-2: #eef6ff;
  --card-bg: #ffffff;
  --accent: #2563eb; /* ×›×—×•×œ */
  --accent-2: #22c55e; /* ×™×¨×•×§ */
  --muted: #6b7280;
  --danger: #ef4444;
  --radius: 12px;
  --page-padding: 20px;
  --max-width: 760px;
  --shadow: 0 6px 18px rgba(22, 28, 37, 0.08);
  --glass: rgba(255,255,255,0.6);
}

/* ×‘×¡×™×¡ */
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  padding:0;
  direction: rtl; /* ×‘×˜×—×•×Ÿ ×›×¤×•×œ - HTML ×›×‘×¨ ××¦×™×’ dir=rtl */
  font-family: "Segoe UI", "Helvetica Neue", Arial, "Alef", system-ui, -apple-system;
  background: linear-gradient(180deg, var(--bg-color-1), var(--bg-color-2));
  color: #0f172a;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

body {
  display: block;
  margin: 0;
  padding: 40px 20px;  /* ×¨×™×•×•×— × ×¢×™× ××›×œ ×”×¦×“×“×™× */
  background: linear-gradient(180deg, var(--bg-color-1), var(--bg-color-2));
  color: #0f172a;
  font-family: "Segoe UI", "Helvetica Neue", Arial, "Alef", system-ui, -apple-system;
  overflow-x: hidden; /* ××™×Ÿ ×’×œ×™×œ×” ×™××™× ×” */
}



#formScreen, #nameScreen {
  margin: 0 auto;
  box-sizing: border-box;
  border-radius: var(--radius);
  max-width: var(--max-width);
  background: linear-gradient(180deg, rgba(255,255,255,0.9), var(--glass));
  padding: 28px;
  box-shadow: var(--shadow);
  border: 1px solid rgba(15,23,42,0.04);
}

/* ×›×¨×˜×™×¡ ×¢×‘×•×¨ ×›×œ ××¡×š */
#nameScreen, #formScreen{
  width:100%;
  max-width: var(--max-width);
  background: linear-gradient(180deg, rgba(255,255,255,0.9), var(--glass));
  border-radius: var(--radius);
  padding: 28px;
  box-shadow: var(--shadow);
  border: 1px solid rgba(15,23,42,0.04);
}

/* ×›×•×ª×¨×•×ª ×•×˜×§×¡×˜ */
h2{
  margin:0 0 8px 0;
  font-size:1.6rem;
  letter-spacing:0.2px;
}
p{
  margin:0 0 18px 0;
  color:var(--muted);
  line-height:1.45;
}

/* ×”×¡×ª×¨×” ×¤×©×•×˜×” */
.hidden{ display:none !important; }

/* ×©×“×•×ª ×§×œ×˜ */
input[type="text"],
input[type="password"],
input[type="email"],
textarea{
  width:100%;
  padding: 12px 14px;
  font-size: 16px;
  border-radius:10px;
  border: 1px solid #e6e9ef;
  background: #fff;
  outline: none;
  color: #0b1220;
  transition: box-shadow .12s ease, border-color .12s ease, transform .06s ease;
  text-align: right;
}

/* ×©×“×” ×˜×§×¡×˜ ×¨×‘ ×©×•×¨×•×ª */
textarea{
  min-height:88px;
  line-height:1.5;
  resize: none; /* ××•×¤×¢×œ ×’× ×‘-JS */
  white-space: pre-wrap;
}

/* ××¦×‘ ×¤×•×§×•×¡ */
input:focus, textarea:focus{
  border-color: rgba(37,99,235,0.85);
  box-shadow: 0 6px 18px rgba(37,99,235,0.08);
}

/* ×›×¤×ª×•×¨×™× ×›×œ×œ×™×™× */
button{
  cursor:pointer;
  border: none;
  outline: none;
  transition: transform .08s ease, box-shadow .08s ease, opacity .08s ease;
  font-weight:600;
}

/* ×›×¤×ª×•×¨ ×”××©×š */
#startBtn{
  background: linear-gradient(90deg, var(--accent), #3b82f6);
  color: white;
  padding: 12px 18px;
  border-radius: 10px;
  font-size: 16px;
  box-shadow: 0 8px 20px rgba(37,99,235,0.12);
}

/* ×›×¤×ª×•×¨ ×©×œ×™×—×ª ×˜×•×¤×¡ */
form button[type="submit"]{
  background: linear-gradient(90deg, var(--accent-2), #16a34a);
  color:white;
  padding: 12px 18px;
  border-radius: 10px;
  font-size: 16px;
  display:inline-block;
}

/* ×›×¤×ª×•×¨ ×× ×”×œ (×”×•×—×œ×£ ×‘Ö¾adminBox ××š × ××§×“ ×¡×˜×™×™×œ) */
#adminAccess{
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:flex-end;
  margin-top:14px;
}

/* ×›×¤×ª×•×¨ ×¢×’×•×œ ×œ××™×©×•×¨ ×× ×”×œ */
#adminSubmit{
  width:50px;
  height:50px;
  display:inline-grid;
  place-items:center;
  border-radius:50%;
  background: var(--accent-2);
  color:#fff;
  font-size:20px;
  box-shadow: 0 8px 18px rgba(34,197,94,0.12);
  border: none;
}

/* ×›×¤×ª×•×¨ ×›× ×™×¡×ª ×× ×”×œ ×”××§×•×¨×™ (×œ× ×‘×©×™××•×© ×× ×”×•×—×œ×£) */
#adminBtn{
  background:transparent;
  color:var(--accent);
  border-radius:8px;
  padding:8px 12px;
  border:1px dashed rgba(37,99,235,0.12);
}

/* ×›×¤×ª×•×¨ ×¢×œ×™×•×Ÿ ×©×××œ×™ (×—×–×¨×”) */
.top-left-btn{
  position: fixed;
  top: 18px;
  left: 18px;
  z-index: 9999;
  background: #fff;
  border-radius: 10px;
  padding: 10px 12px;
  box-shadow: 0 8px 24px rgba(2,6,23,0.12);
  border: 1px solid rgba(2,6,23,0.06);
  font-size:18px;
}

/* ×¡×˜×™×™×œ ×œ×©××œ×•×ª */
#questionsContainer{
  display:flex;
  flex-direction:column;
  gap:14px;
  margin-bottom:18px;
  margin-top:8px;
}
.question{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.question label{
  font-weight:700;
  font-size:15px;
  color:#071032;
  margin-bottom:2px;
}

/* ×©×’×™××•×ª */
input.error, textarea.error{
  border-color: rgba(239,68,68,0.95);
  box-shadow: 0 6px 18px rgba(239,68,68,0.06);
}

/* ×”×•×“×¢×•×ª ×× ×”×œ ×•×©×’×™××•×ª */
#adminMessage{
  font-size:14px;
}
.form-message{
  margin-top:12px;
  padding:10px 12px;
  border-radius:8px;
  font-weight:600;
}
.form-message.success{
  background: rgba(34,197,94,0.08);
  color: #065f46;
  border: 1px solid rgba(34,197,94,0.12);
}
.form-message.error{
  background: rgba(239,68,68,0.06);
  color: #9b1c1c;
  border: 1px solid rgba(239,68,68,0.12);
}

/* ×”×ª×××•×ª ×œ××•×‘×™×™×œ */
@media (max-width:560px){
  body{ padding:20px 12px; }
  #nameScreen, #formScreen{
    padding:18px;
    border-radius:10px;
  }
  h2{ font-size:1.35rem; }
  input[type="text"], textarea{ font-size:15px; padding:10px; }
  #adminAccess{ flex-direction:column; align-items:stretch; }
  #adminSubmit{ width:48px; height:48px; align-self:flex-start; }
  .top-left-btn{ left:12px; top:12px; padding:8px; }
}

/* ××™×¤×•×Ÿ: ×›×¤×ª×•×¨×™× ×§×œ×™× ×œ×œ×—×™×¦×” */
button:active{ transform: translateY(1px) scale(0.997); opacity:0.98; }

/* × ×¨××•×ª ×˜×•×‘×” ×œ×”×“×¤×¡×” (××•×¤×¦×™×•× ×œ×™) */
@media print{
  body{ background: #fff; }
  .top-left-btn, #adminAccess { display:none; }
  #nameScreen, #formScreen{ box-shadow:none; border:none; }
}

#formScreen {
  width: 100%;
  max-width: 760px;
  margin: 0 auto;
  padding: 20px;
  overflow-x: hidden;
  box-sizing: border-box;
}

#questionsContainer {
  width: 100%;
  overflow-x: hidden;
}

textarea {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}
#formMessage {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(34,197,94,0.95);
  color: #fff;
  font-size: 1.4rem;
  font-weight: bold;
  padding: 18px 36px;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  display: none;
  z-index: 9999;
  text-align: center;
  animation: fadeInOut 2.6s ease forwards;
}

@keyframes fadeInOut {
  0% { opacity: 0; transform: translate(-50%, -60%); }
  15% { opacity: 1; transform: translate(-50%, -50%); }
  85% { opacity: 1; transform: translate(-50%, -50%); }
  100% { opacity: 0; transform: translate(-50%, -40%); }
}
/* ğŸ¯ ×¨×§ ×ª××•× ×” ×××•×¨×›×–×ª ×‘×”×“×¨ */
.hero-header {
  display: flex;
  justify-content: center;     /* ×××¨×›×– ××•×¤×§×™×ª */
  align-items: center;         /* ×××•×¨×›×– ×× ×›×™×ª (×× ×™×© ×’×•×‘×”) */
  text-align: center;
  background: transparent;     /* ××™×Ÿ ×¨×§×¢ ×›×œ×œ */
  box-shadow: none;
  border: none;
}

/* ğŸ–¼ï¸ ×”×ª××•× ×” ×¢×¦××” */
.hero-header img {
  width: 300px;                /* ğŸ“ ×’×•×“×œ ×”×ª××•× ×” */
  height: auto;
  border-radius: 20px;         /* ×¤×™× ×•×ª ×¨×›×•×ª */
  display: block;
  margin: 0 auto;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}


/* ××•×‘×™×™×œ */
@media (max-width: 560px) {
  .hero-header img {
    width: 300px;  /* ×’×•×“×œ ×§×˜×Ÿ ×™×•×ª×¨ ×œ××¡×›×™× ×§×˜× ×™× */
  }
}


.line1 {
  border: none;                /* ××‘×˜×œ ××ª ×”×§×• ×”×“×™×¤×•×œ×˜×™ */
  height: 1.7px;                 /* ×¢×•×‘×™ ×”×§×• */
  background-color: #1eaeda;   /* ×¦×‘×¢ (×›×—×•×œ ×œ××©×œ) */
  border-radius: 2px;          /* ×¤×™× ×•×ª ×¨×›×•×ª */
  width: 60%;                  /* ××•×¨×š ×”×§×• */
  margin: 20px auto;           /* ×××•×¨×›×– */
}

.logo-container {
  display: flex;
  justify-content: center;   /* ×××¨×›×– ××•×¤×§×™×ª */
  align-items: center;       /* ×××¨×›×– ×× ×›×™×ª */
  height: 320px;             /* ×’×•×‘×” ××–×•×¨ ×”×œ×•×’×• */
}

.fullName {
  display: flex;
  justify-content: center;   /* ×××¨×›×– ××ª ×”×ª×•×›×Ÿ ×‘×ª×•×š ×”×ª×™×‘×” */
  align-items: center;       /* ×××¨×›×– ×× ×›×™×ª */
  width: 220px;
  margin: 0 auto;            /* âœ… ×××¨×›×– ××ª ×›×œ ×”×ª×™×‘×” ×¢×¦××” */
  text-align: center;        /* ×× ×™×© ×˜×§×¡×˜ ××• ×¤×œ×™×™×¡×”×•×œ×“×¨ */
}


.fullName::placeholder {
  text-align: center;
  color: rgb(49, 145, 21);
  font-weight: bolder;
  font-size: large;
}


.gradient-title {
  text-align: center;
  font-size: 2.2rem;
  font-weight: 800;
  background: linear-gradient(to left, #413261b4, #2c5458bd); /* ×›×—×•×œ â† ×™×¨×•×§ */
  -webkit-background-clip: text;   /* ×’×•×¨× ×œ×¦×‘×¢ ×”×’×¨×“×™×× ×˜ ×œ××œ× ××ª ×”××•×ª×™×•×ª */
  -webkit-text-fill-color: transparent; /* ×”×•×¤×š ××ª ×”×˜×§×¡×˜ ×¢×¦××• ×œ×©×§×•×£ */
  background-clip: text;
  color: transparent;
  letter-spacing: 0.5px;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.pi1{
  font-weight: bold;
  color: rgb(73, 73, 73);
  text-align: center;
  font-size: 20px;
}
.op1 {
  border: none;                /* ××‘×˜×œ ××ª ×”×§×• ×”×“×™×¤×•×œ×˜×™ */
  height: 3px;                 /* ×¢×•×‘×™ ×”×§×• */
  background-color: #525274;   /* ×¦×‘×¢ (×›×—×•×œ ×œ××©×œ) */
  border-radius: 2px;          /* ×¤×™× ×•×ª ×¨×›×•×ª */
  width: 130px;                  /* ××•×¨×š ×”×§×• */
  margin: 20px auto;
}
hr.op1 { border: 0; height: 1px; background: linear-gradient(to left, transparent, #ccc, transparent); width: 80%; margin: 20px auto; }

.co1 {
  border: solid 1px rgba(41, 41, 48, 0.418);
  border-radius: 12px;
 max-width: 220px;
 margin-bottom: 20px;
justify-content: center;
margin: 10px auto;
padding: 12px 12px;
display: flex;
align-items: center;
  flex-direction: column;
  margin-top: 35px;
  margin-bottom: 35px;
}
 


  </style>
</head>
<body>


    <!-- ×›×¤×ª×•×¨ ×¢×œ×™×•×Ÿ ×©×××œ×™ -->
<!-- ×›×¤×ª×•×¨ ×¢×œ×™×•×Ÿ ×©×××œ×™ -->
<button id="topLeftBtn" title="×—×–×¨×”" class="top-left-btn hidden">ğŸ”™</button>


<!-- ××¡×š ×¤×ª×™×—×” -->
<div id="nameScreen">
  <h2 class="gradient-title" style="text-align: center">×‘×¨×•×š ×”×‘×</h2>
  <hr class="op1">
  <div class="co1">
    <p class="pi1">×©××œ×•×Ÿ ×¤×ª×™×—×” ×œ××˜×•×¤×œ×™× ×—×“×©×™×</p>
    <p class="pi1">×× × ×”×–×Ÿ ××ª ×©××š ×”××œ× ×›×“×™ ×œ×”×ª×—×™×œ ××ª ×”×©××œ×•×Ÿ</p>
  </div>

  <div class="fullName">
    <input class="fullName" type="text" id="fullName" placeholder="×©× ××œ×" required />
  </div>
  <br><br>
  <div style="text-align: center;">
    <button id="startBtn">×”××©×š</button>
  </div>
  <br>
  <div style="display:flex; flex-direction:column; align-items:center;">
    <button id="adminBtn">×›× ×™×¡×ª ×× ×”×œ</button>
  </div>
</div>

<!-- ××¡×š ×©××œ×•×Ÿ -->
<div id="formScreen" class="hidden">  <!-- ×©×™× ×œ×‘ ×œÖ¾class="hidden" -->
  <h2>×˜×•×¤×¡ ××™× ×˜×™×™×§</h2>
  <form id="intakeForm">
    <div id="questionsContainer"></div>
    <button type="submit">×©×œ×—</button>
  </form>
</div>
<div id="nameScreen"></div>

<div id="formMessage">âœ… × ×©×œ×— ×‘×”×¦×œ×—×”!</div>

 <script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
  const supabaseUrl = "https://tgfqsmarvznpzwdixvye.supabase.co";
  const supabaseKey =
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRnZnFzbWFydnpucHp3ZGl4dnllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3OTM1NzEsImV4cCI6MjA3NjM2OTU3MX0.ui5rHWh8KgSmhYrl_unozb9rwAaZQeTNEeMZF63lhYM";
  const supabase = createClient(supabaseUrl, supabaseKey);

  const nameScreen = document.getElementById("nameScreen");
  const formScreen = document.getElementById("formScreen");
  const startBtn = document.getElementById("startBtn");
  const adminBtn = document.getElementById("adminBtn");
  const fullNameInput = document.getElementById("fullName");
  const form = document.getElementById("intakeForm");
  const questionsContainer = document.getElementById("questionsContainer");
  const topLeftBtn = document.getElementById("topLeftBtn");

  // ×‘×™×˜×•×œ resize ×œ×ª×™×‘×•×ª ×˜×§×¡×˜
  const style = document.createElement("style");
  style.innerHTML = `textarea { resize: none !important; }`;
  document.head.appendChild(style);

// ×¨×©×™××ª ×©××œ×•×ª ×‘×¡×™×¡ (×ª××™×“ ×ª×•×¤×™×¢)
const baseQuestions = [
  "×˜×œ×¤×•×Ÿ × ×™×™×“",
  "×›×ª×•×‘×ª email",
  "×ª××¨×™×š ×œ×™×“×”",
  "××¦×‘ ××©×¤×—×ª×™",
  "××§×¦×•×¢ / ×œ×™××•×“×™× (×ª×—×•×)",
  "×‘×–×× ×™ ×”×¤× ×•×™",
  "××™×š ×”×™×™×ª ××ª××¨ ××ª ××¢×¨×›×ª ×”×ª××™×›×” ×©×œ×š (××©×¤×—×”, ×—×‘×¨×™×, ×§×”×™×œ×”)?",
  "××™×š ×”×¨×’×œ×™ ×”×©×™× ×” ×©×œ×š?",
  "×”×× × ×•×˜×œ ×˜×™×¤×•×œ ×ª×¨×•×¤×ª×™ ×§×‘×•×¢?",
  "×”×× ×™×© ×”×™×¡×˜×•×¨×™×” ×©×œ ×§×©×™×™× ×¨×’×©×™×™×, ×—×¨×“×•×ª, ×“×™×›××•×Ÿ ××• ×˜×¨××•××”?",
  "××ª×™ ×•/××•-××™×š ×”×—×œ×” ×”×‘×¢×™×”?",
  "××”× ×”×§×©×™×™× ×”××¨×›×–×™×™× ×©××ª/×” ××ª××•×“×“/×ª ××™×ª× ×›×™×•×?",
  "××”×• ×”×˜×¨×™×’×¨ ×”××¢×•×¨×¨ ××ª ×”×§×•×©×™?",
  "××” ×”×‘×™× ××•×ª×š ×œ×¤× ×•×ª ×œ×˜×™×¤×•×œ ×“×•×•×§× ×¢×›×©×™×•?",
  "××™×œ×• × ×¡×™×•× ×•×ª ×¢×©×™×ª ×¢×œ ×× ×ª ×œ×©× ×•×ª ××ª ×”××¦×‘?",
  "×”×× ×”×™×• × ×¡×™×•× ×•×ª ×§×•×“××™× ×œ×˜×¤×œ ×‘×‘×¢×™×”? ×× ×›×Ÿ ××”×?",
  "××” ××™×˜×™×‘ ××ª ×—×™×™×š? ××” ××—×–×§ ××•×ª×š ×•×‘×¤×¨×˜ ×›×©×§×©×” ×œ×š?",
  "×”×× ×™×© ×× ×©×™× × ×•×¡×¤×™× ×‘××©×¤×—×” ×©×¡×•×‘×œ×™× ××‘×¢×™×•×ª ×“×•××•×ª?",
  "××” ×—×©×•×‘ ×œ×™ ×œ×“×¢×ª ×¢×œ×™×š ×›×‘×¨ ×¢×›×©×™×• ×›×“×™ ×©×”××¤×’×© ×™×”×™×” ×œ×š × ×•×— ×•×‘×˜×•×—?",
  "××” ×”×™×™×ª ×¨×•×¦×” ×œ×”×©×™×’ ×‘×˜×™×¤×•×œ? ××™×š ×ª×“×¢ ×©×”×˜×™×¤×•×œ ×¢×•×–×¨ ×œ×š?"
];

// ×›××Ÿ × ××¡×•×£ ×’× ××ª ×”×©××œ×•×ª ××”Ö¾Supabase
let combinedQuestions = [];

// ×˜×¢×™× ×ª ×©××œ×•×ª × ×•×¡×¤×•×ª ××”Ö¾Supabase
async function loadQuestionsFromDB() {
  try {
    const { data, error } = await supabase
      .from("intake_questions")
      .select("*")
      .order("id");

    if (error) {
      console.error("×©×’×™××” ×‘×˜×¢×™× ×” ××”Ö¾Supabase:", error);
      return baseQuestions; // fallback ×× ×™×© ×©×’×™××”
    }

    // ×©××œ×•×ª ×—×“×©×•×ª ×‘×œ×‘×“ (×œ×× ×•×¢ ×›×¤×™×œ×•×™×•×ª ×× ××™×©×”×• ×”×•×¡×™×£ ××•×ª×Ÿ ×©×•×‘)
    const dbQuestions = data.map(q => q.question_text);
    const uniqueDB = dbQuestions.filter(q => !baseQuestions.includes(q));

    // ××™×—×•×“ ×”×¨×©×™××•×ª
    combinedQuestions = [...baseQuestions, ...uniqueDB];
    console.log("×¡×”×´×› ×©××œ×•×ª:", combinedQuestions.length);

    // ×™×¦×™×¨×ª ×”×©××œ×•×Ÿ ×”×“×™× ××™
    renderQuestions();
  } catch (e) {
    console.error(e);
  }
}

// ×¤×•× ×§×¦×™×” ×©××¦×™×™×¨×ª ××ª ×”×©××œ×•×Ÿ ×¢×œ ×”××¡×š
function renderQuestions() {
  questionsContainer.innerHTML = "";
  combinedQuestions.forEach(q => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `
      <label>${q}</label>
      <textarea required placeholder="×›×ª×•×‘ ×ª×©×•×‘×” ×›××Ÿ"></textarea>
    `;
    questionsContainer.appendChild(div);
  });
}

// ×§×¨×™××” ×‘×¢×ª ×˜×¢×™× ×ª ×”×“×£
await loadQuestionsFromDB();


  // ×ª×™×‘×ª ×§×•×“ ×× ×”×œ (×¨×§ ×‘×“×£ ×”×¨××©×•×Ÿ)
const adminBox = document.createElement("div");
adminBox.innerHTML = `
  <div id="adminAccess" style="margin-top:20px; display:flex; flex-direction:column; align-items:center; gap:10px;">
    <div style="display:flex; gap:10px; align-items:center;">
      <input type="password" id="adminCodeInput" placeholder="ğŸ”’ ×”×–×Ÿ ×§×•×“ ×× ×”×œ ×œ×’×™×©×”"
             style="padding:10px; text-align:right; border-radius:8px; border:1px solid #ccc; font-size:16px; direction:rtl;">
      <button id="adminSubmit"
              style="padding:10px; border:none; background:#22c55e; color:#fff;
                     border-radius:50%; cursor:pointer; width:50px; height:50px; font-size:22px;">
        âœ…
      </button>
    </div>
    <p id="adminMessage" style="color:red; margin-top:8px; font-weight:bold;"></p>
    <button id="adminPanelBtn"
            style="display:none; padding:12px 20px; background:#2563eb; color:white;
                   border:none; border-radius:10px; font-size:16px; font-weight:bold;
                   box-shadow:0 8px 24px rgba(37,99,235,0.2); cursor:pointer;">
      ğŸ§© ×›× ×™×¡×” ×œ××¢×¨×›×ª ×”× ×™×”×•×œ
    </button>
  </div>
`;
adminBtn.replaceWith(adminBox);

const adminCodeInput = document.getElementById("adminCodeInput");
const adminSubmit = document.getElementById("adminSubmit");
const adminMessage = document.getElementById("adminMessage");
const adminPanelBtn = document.getElementById("adminPanelBtn");

// ×× ×›×‘×¨ ××•××ª ×‘×¢×‘×¨
if (localStorage.getItem("admin_verified") === "true") {
  adminMessage.style.color = "green";
  adminMessage.innerText = "âœ”ï¸ ×’×™×©×” ×××•×©×¨×ª";
  adminPanelBtn.style.display = "inline-block";
}
// âœ… ×”×¡×ª×¨×ª ×”×’×™×©×” ×œ×× ×”×œ ×¢×“ ×©×™×›×ª×‘ "gh"
const adminAccess = document.getElementById("adminAccess");

// ×× ××™×Ÿ ×¡×™××•×Ÿ ×‘×–×™×›×¨×•×Ÿ â€“ ××¡×ª×™×¨×™×
if (!localStorage.getItem("admin_revealed")) {
  adminAccess.style.display = "none";
}

// ×××–×™×Ÿ ×œ×©×“×” ×”×©×: ×× × ×›×ª×‘ "gh" â€“ ×—×•×©×£ ××ª ××–×•×¨ ×”×× ×”×œ
fullNameInput.addEventListener("input", () => {
  if (fullNameInput.value.trim().toLowerCase() === "1×¢×™×“×Ÿ") {
    adminAccess.style.display = "flex";
    localStorage.setItem("admin_revealed", "true");
  }
});

// ×‘×“×™×§×ª ×§×•×“
adminSubmit.onclick = () => {
  const code = adminCodeInput.value.trim();
  if (code === "15435000") {
    localStorage.setItem("admin_verified", "true");
    adminMessage.style.color = "green";
    adminMessage.innerText = "âœ”ï¸ ×›× ×™×¡×” ×××•×©×¨×ª!";
    adminPanelBtn.style.display = "inline-block";
  } else {
    adminMessage.style.color = "red";
    adminMessage.innerText = "âŒ ×§×•×“ ×©×’×•×™, × ×¡×” ×©×•×‘.";
  }
};

// ×›×¤×ª×•×¨ ××¢×‘×¨ ×œ××¢×¨×›×ª ×”× ×™×”×•×œ
adminPanelBtn.onclick = () => {
  window.location.href = "summaries.html";
};


  // ××¢×‘×¨ ×œ×©××œ×•×Ÿ
  startBtn.onclick = () => {
    const fullName = fullNameInput.value.trim();
    if (!fullName) {
      fullNameInput.classList.add("error");
      return;
    }

    localStorage.setItem("intake_full_name", fullName);
    fullNameInput.classList.remove("error");

    // ××¢×‘×¨ ×‘×™×Ÿ ×”××¡×›×™×
    nameScreen.classList.add("hidden");
    formScreen.classList.remove("hidden");

    // ××¦×™×’ ××ª ×”×›×¤×ª×•×¨ ×”×¢×œ×™×•×Ÿ
    topLeftBtn.classList.remove("hidden");
  };

  // ×›×¤×ª×•×¨ ×—×–×¨×” ğŸ”™
  topLeftBtn.onclick = () => {
    formScreen.classList.add("hidden");
    nameScreen.classList.remove("hidden");
    topLeftBtn.classList.add("hidden");
  };

  form.onsubmit = async (e) => {
  e.preventDefault();
  const fullName = localStorage.getItem("intake_full_name");
  const answers = {};
  let valid = true;

  const textareas = form.querySelectorAll("textarea");
  textareas.forEach((ta, i) => {
    if (!ta.value.trim()) {
      ta.classList.add("error");
      valid = false;
    } else {
      ta.classList.remove("error");
      answers[combinedQuestions[i]] = ta.value.trim(); // âœ… ×ª×•×§×Ÿ ×›××Ÿ
    }
  });

  if (!valid) return;

  const now = new Date();
  const date = now.toLocaleDateString("he-IL");
  const time = now.toLocaleTimeString("he-IL");

  // ×©××™×¨×” ×‘×œ×•×§×œ ×¡×˜×•×¨×’'
  const history = JSON.parse(localStorage.getItem("intake_history") || "[]");
  history.push({ fullName, date, time, answers });
  localStorage.setItem("intake_history", JSON.stringify(history));

  // ×©×œ×™×—×” ×œ-Supabase
  const { error } = await supabase
    .from("intake_forms")
    .insert([{ full_name: fullName, answers }]);

  const msg = document.getElementById("formMessage");
if (error) {
  msg.textContent = "âŒ ×©×’×™××” ×‘×©×œ×™×—×”, × ×¡×” ×©×•×‘.";
  msg.style.background = "rgba(239,68,68,0.95)";
} else {
  msg.textContent = "âœ… × ×©×œ×— ×‘×”×¦×œ×—×”!";
  msg.style.background = "rgba(34,197,94,0.95)";
}
msg.style.display = "block";

setTimeout(() => {
  msg.style.display = "none";
  if (!error) {
    form.reset();
    formScreen.classList.add("hidden");
    nameScreen.classList.remove("hidden");
    topLeftBtn.classList.add("hidden");
  }
}, 2500);

};

</script>

</body>
</html>
